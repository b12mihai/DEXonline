<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="{$cssRoot}/polar.css" rel="stylesheet" type="text/css"/>
    <title>DEX online - Sincronizare client</title>
  </head>

  <body>
    <p>Acest script exportă baza de date a <i>DEX online</i> sau
    porţiuni ale ei. Dacă doriţi să scrieţi un client care să
    transfere baza de date şi să o folosească off-line, comunicaţi cu
    acest script pentru a sincroniza periodic baza de date.</p>

    <h2>Generalităţi</h2>

    <ul>

      <li>Copierea, folosirea şi redistribuirea definiţiilor
      din <i>DEX online</i> sunt permise
      sub <a href="faq.php#licenta">Licenţa Publică Generală
      GNU</a>.</li>

      <li>Este obligatoriu ca mecanismul pe care îl folosiţi pentru transfer
      să accepte date comprimate cu gzip. Mai exact, trebuie ca, la
      stabilirea conexiunii HTTP, să setaţi antetul <b>Accept-Encoding:
      gzip</b> (cel puţin). Datele pe care le primiţi sunt comprimate cu
      gzip; există biblioteci publice pentru cam orice limbaj pe care le
      puteţi folosi pentru a decomprima datele. Dacă nu vă conformaţi
      acestei cerinţe, veţi primi un răspuns 403 (Forbidden). De
      remarcat că orice browser modern foloseşte gzip, deci îl puteţi
      folosi pentru a inspecta vizual datele.</li>

      <li>Un <b>timestamp</b> semnifică numărul de secunde trecute de
      la 1 ianuarie 1970 GMT. Limbajul în care dezvoltaţi aplicaţia ar
      trebui să aibă funcţii de conversie din data/ora calendaristică
      în timestamp. Când clientul se conectează la server, trebuie
      să-i comunice serverului timestamp-ul ultimei actualizări făcute
      (sau 0 dacă este prima oară când clientul se conectează).
      Scriptul va returna toate datele modificate începând cu acel
      timestamp, precum şi timestamp-ul curent, pe care îl puteţi
      păstra şi folosi ca parametru la următoarea actualizare.</li>

      <li>Serverul îşi exportă datele în ordinea cronologică a
      modificărilor. Dacă conexiunea se întrerupe prematur, clientul
      poate reapela scriptul cu ultimul timestamp pe care l-a primit,
      pentru a continua de unde a rămas.</li>

      <li><a href="html/formatting.html">Instrucţiunile</a> despre
      formatarea definiţiilor sunt accesibile din pagina de
      contribuţii.</li>

    </ul>

    <h2>Date exportate</h2>

    Scriptul exportă separat diverse tipuri de date. Pentru a
    transfera toate datele, trebuie să invocaţi de mai multe ori acest
    script, folosind parametrul GET <b>export=...</b> pentru a
    controla tipul de date. Nu este obligatoriu să transferaţi toate
    tipurile de date la fiecare sincronizare a clientului, dar am
    făcut această separare pentru uşurinţa implementării.



    <h3>Surse</h3>

    DEX online îşi preia definiţiile din diferite "surse", care de
    obicei se referă la un dicţionar tipărit, identificat prin titlu,
    autor, editură şi an de apariţie. Lista de surse este întotdeauna
    exportată complet. Ea se modifică rar şi vă recomandăm să o
    resincronizaţi numai dacă observaţi că aţi primit definiţii care
    folosesc surse necunoscute.<br/><br/>

    Parametri acceptaţi:

    <ul>
      <li>export=sources</li>
    </ul>

    Formatul este:

    <pre class="exportSample">
&lt;Sources>
  &lt;NumResults><i>număr</i>&lt;/NumResults>
  &lt;Source>
    &lt;Id><i>număr</i>&lt;/Id>
    &lt;ShortName><i>şir</i>&lt;/ShortName>
    &lt;Name><i>şir</i>&lt;/Name>
    &lt;Author><i>şir</i>&lt;/Author>
    &lt;Publisher><i>şir</i>&lt;/Publisher>
    &lt;Year><i>şir</i>&lt;/Year>
  &lt;/Source>
  ....
&lt;/Sources></pre>

    De exemplu:

    <pre class="exportSample">
&lt;Sources>
  &lt;NumResults>22&lt;/NumResults>
  &lt;Source>
    &lt;Id>1&lt;/Id>
    &lt;ShortName>DEX '98&lt;/ShortName>
    &lt;Name>Dicţionarul explicativ al limbii române&lt;/Name>
    &lt;Author>Academia Română, Institutul de Lingvistică "Iorgu Iordan"&lt;/Author>
    &lt;Publisher>Editura Univers Enciclopedic&lt;/Publisher>
    &lt;Year>1998&lt;/Year>
  &lt;/Source>
  ....
&lt;/Sources></pre>



    <h3>Definiţii</h3>

    Parametri acceptaţi:

    <ul>
      <li>export=definitions</li>
      <li>timestamp=<i>număr</i></li>      
    </ul>    

    Formatul este:

    <pre class="exportSample">
&lt;Definitions>
  &lt;NumResults><i>număr</i>&lt;/NumResults>
  &lt;Definition>                         ;; Exemplu de definiţie modificată
    &lt;Id><i>număr</i>&lt;/Id>
    &lt;Timestamp><i>număr</i>&lt;/Timestamp>
    &lt;UserName><i>şir</i>&lt;/UserName>
    &lt;SourceId><i>număr</i>&lt;/SourceId>
    &lt;Text><i>şir</i>&lt;/Text>
    &lt;LexemId><i>număr</i>&lt;/LexemId>
    &lt;LexemId><i>număr</i>&lt;/LexemId>
    &lt;LexemId><i>număr</i>&lt;/LexemId>
    ...
  &lt;/Definition>
  &lt;Definition>                         ;; Exemplu de definiţie ştearsă
    &lt;Id><i>număr</i>&lt;/Id>
    &lt;Timestamp><i>număr</i>&lt;/Timestamp>
    &lt;Deleted/>
  &lt;/Definition>
  ....
&lt;/Definitions></pre>

    De exemplu:

    <pre class="exportSample">
&lt;Definitions>
  &lt;NumResults>2&lt;/NumResults>
  &lt;Definition> 
    &lt;Id>9432&lt;/Id>
    &lt;Timestamp>1189656131&lt;/Timestamp>
    &lt;UserName>ana_zecheru&lt;/UserName>
    &lt;SourceId>1&lt;/SourceId>
    &lt;Text>@FÁTA MORGÁNA@ s.f. Fenomen optic frecvent în regiunile calde, datorită căruia imaginile
obiectelor aflate la (sau dincolo de) orizont apar ca şi cum s-ar reflecta într-o apă. ** Apariţie
înşelătoare, iluzie trecătoare. - Cuv. it.&lt;/Text>
    &lt;LexemId>35579&lt;/LexemId>
    &lt;LexemId>90887&lt;/LexemId>
    &lt;LexemId>90889&lt;/LexemId>
  &lt;/Definition>
  &lt;Definition>
    &lt;Id>293845&lt;/Id>
    &lt;Timestamp>1189680395&lt;/Timestamp>
    &lt;Deleted/>
  &lt;/Definition>
&lt;/Definitions></pre>

    Precizări:

    <ul>

      <li>Definiţiile sunt listate în ordinea crescătoare a
      timestamp-ului modificării. Pentru definiţiile şterse este
      listat doar câmpul <code>&lt;Deleted/></code>. Pentru
      definiţiile modificate sau adăugate, sunt listaţi autorul,
      sursa, textul propriu-zis şi zero sau mai multe cuvinte (numite
      lexeme) cu care definiţia este asociată.</li>

      <li>Este posibil ca, în cazul unei definiţii şterse, să vă fie
      transmis un identificator pe care clientul dumneavoastră nu îl
      are în baza de date. Acest lucru se întâmplă când o definiţie
      este ştearsă pe site fără să fi trecut vreodată prin starea
      "activă" (iniţial toate definiţiile trimise pentru <i>DEX
      online</i> intră în starea "temporară" până când sunt
      moderate). În această situaţie, ignoraţi pur şi simplu
      înregistrarea.</li>

      <li>Când setul de lexeme asociate cu o definiţie se schimbă,
      întreaga definiţie este resincronizată.</li>

    </ul>



    <h3>Flexiuni</h3>

    Această categorie exportă tipurile distincte de flexiuni folosite de
    <i>DEX online,</i> care reprezintă un subset al flexiunilor limbii
    române (de exemplu, momentan <i>DEX online</i> nu foloseşte
    vocativul substantivelor). Şi această categorie este exportată
    complet, întrucât se modifică foarte rar (vă recomandăm să o
    transferaţi numai atunci când, la sincronizarea lexemelor,
    întâlniţi o valoare nouă pentru parametrul <code>InflId</code>).<br/><br/>

    Parametri acceptaţi:

    <ul>
      <li>export=inflections</li>
    </ul>

    Formatul este:

    <pre class="exportSample">
&lt;Inflections>
  &lt;NumResults><i>număr</i>&lt;/NumResults>
  &lt;Inflection>
    &lt;Id><i>număr</i>&lt;/Id>
    &lt;Description><i>şir</i>&lt;/Description>
  &lt;/Inflection>
  &lt;Inflection>
    ...
  &lt;/Inflection>
&lt;/Inflections></pre>

    De exemplu:

    <pre class="exportSample">
&lt;Inflections>
  &lt;NumResults>86&lt;/NumResults>
  &lt;Inflection>
    &lt;Id>1&lt;/Id>
    &lt;Description>Substantiv masculin, Nominativ-Acuzativ, singular, nearticulat&lt;/Description>
  &lt;/Inflection>
  ...
  &lt;Inflection>
    &lt;Id>58&lt;/Id>
    &lt;Description>Verb, Indicativ, prezent, persoana a II-a, plural&lt;/Description>
  &lt;/Inflection>
  ...
&lt;/Inflections></pre>



    <h3>Lexeme</h3>

    "Lexemul" este un termen lingvistic pentru cuvânt. Un lexem este
    caracterizat printr-un identificator numeric unic, un nume, o
    descriere opţională (folosită pentru diferenţierea omonimelor) şi
    o listă de forme flexionare.

    Parametri acceptaţi:

    <ul>
      <li>export=lexems</li>
      <li>timestamp=<i>număr</i></li>      
    </ul>    

    Formatul este:

    <pre class="exportSample">
&lt;Lexems>
  &lt;NumResults><i>număr</i>&lt;/NumResults>
  &lt;Lexem>
    &lt;Id><i>număr</i>&lt;/Id>
    &lt;Timestamp><i>număr</i>&lt;/Timestamp>
    &lt;Form><i>şir</i>&lt;/Form>                    ;; Forma poate include un apostrof înainte de vocala accentuată
    &lt;Description><i>şir</i>&lt;/Description>      ;; Opţional
    &lt;Inflection>                        ;; Formele flexionare
      &lt;InflId><i>număr</i>&lt;/InflId>
      &lt;Form><i>şir</i>&lt;/Form>
    &lt;/Inflection>
    &lt;Inflection>
      &lt;InflId><i>număr</i>&lt;/InflId>
      &lt;Form><i>şir</i>&lt;/Form>
    &lt;/Inflection>
    ...
  &lt/Lexem>
  ....
&lt;/Lexems></pre>

    De exemplu:

    <pre class="exportSample">
&lt;Lexems>
  &lt;NumResults>105&lt;/NumResults>
  &lt;Lexem>
    &lt;Id>57483&lt;/Id>
    &lt;Timestamp>1189683958&lt;/Timestamp>
    &lt;Form>cop'il&lt;/Form>
    &lt;Description>persoană&lt;/Description>
    &lt;Inflection>
      &lt;InflId>1&lt;/InflId>
      &lt;Form>cop'il&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>3&lt;/InflId>
      &lt;Form>cop'ii&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>5&lt;/InflId>
      &lt;Form>cop'ilul&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>8&lt;/InflId>
      &lt;Form>cop'iilor&lt;/Form>
    &lt;/Inflection>
  &lt/Lexem>
  &lt;Lexem>
    &lt;Id>57484&lt;/Id>
    &lt;Timestamp>1189683961&lt;/Timestamp>
    &lt;Form>cop'il&lt;/Form>
    &lt;Description>lăstar&lt;/Description>
    &lt;Inflection>
      &lt;InflId>1&lt;/InflId>
      &lt;Form>cop'il&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>3&lt;/InflId>
      &lt;Form>cop'ili&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>5&lt;/InflId>
      &lt;Form>cop'ilul&lt;/Form>
    &lt;/Inflection>
    ...
    &lt;Inflection>
      &lt;InflId>8&lt;/InflId>
      &lt;Form>cop'ililor&lt;/Form>
    &lt;/Inflection>
  &lt/Lexem>
  ....
&lt;/Lexems></pre>

    Precizări:

    <ul>

      <li>Lexemele sunt listate în ordinea crescătoare a
      timestamp-ului modificării.</li>

      <li>Scriptul nu trimite informaţii despre ştergerea unui
      lexem. Când un lexem este şters în <i>DEX online</i>, el este în
      mod automat disociat de toate definiţiile cu care era
      asociat. Clientul dumneavoastră va primi noile definiţii (când
      sincronizează secţiunea de definiţii) şi va face şi el
      disocierea. Nu este o problemă dacă clientul păstrează lexemul
      pe termen nelimitat, deoarece el nu mai este folosit, iar
      ştergerea unui lexem este o operaţie rară.</li>

      <li>Dacă cel puţin una din formele flexionare se modifică,
      întreg lexemul va fi resincronizat.</li>

      <li>Lexemul are întoteauna cel puţin o formă flexionară. Echipa
      <i>DEX online</i> nu a terminat încă de etichetat toate lexemele
      şi deci paradigmele unor lexeme sunt încă necunoscute. Chiar şi
      acele lexeme au o singură formă flexionară, corespunzătoare unei
      flexiuni "temporare".</li>

      <li>Nu vă recomandăm să folosiţi numele lexemului (cel din
      câmpul form) pentru căutări. Folosiţi formele flexionare pentru
      aceasta. De cele mai multe ori, numele lexemului coincide cu
      prima dintre formele flexionare, iar când nu este aşa, există un
      motiv.</li>

    </ul>

  </body>
</html>
